(()=>{var e={};e.id=559,e.ids=[559],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},9285:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c}),r(2320),r(3567),r(996);var a=r(170),s=r(5002),i=r(3876),n=r.n(i),l=r(6299),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let c=["",{children:["menu",{children:["cart",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2320)),"/app/src/app/menu/cart/checkout/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,3567)),"/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/app/src/app/menu/cart/checkout/page.tsx"],m="/menu/cart/checkout/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/menu/cart/checkout/page",pathname:"/menu/cart/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9189:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,3642,23)),Promise.resolve().then(r.t.bind(r,7586,23)),Promise.resolve().then(r.t.bind(r,7838,23)),Promise.resolve().then(r.t.bind(r,8057,23)),Promise.resolve().then(r.t.bind(r,7741,23)),Promise.resolve().then(r.t.bind(r,3118,23))},3711:(e,t,r)=>{Promise.resolve().then(r.bind(r,7063))},3612:(e,t,r)=>{Promise.resolve().then(r.bind(r,5346))},7063:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>n,j:()=>l});var a=r(7247),s=r(8964);let i=(0,s.createContext)(void 0),n=({children:e})=>{let[t,r]=(0,s.useState)([]),[n,l]=(0,s.useState)("0.00"),[o,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)(0),[u,p]=(0,s.useState)(""),x=e=>{if(!Array.isArray(e.cart)){console.error("Invalid cart data received:",e);return}r(e.cart.map(e=>({...t.find(t=>t.id===e.id),...e}))),l(e.total_price||"0.00")};(0,s.useEffect)(()=>{p((()=>{let e="csrftoken",t=null;if(document.cookie&&""!==document.cookie){let r=document.cookie.split(";");for(let a=0;a<r.length;a++){let s=r[a].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}}return t})()||"")},[]);let h=async()=>{c(!0);try{let e=await fetch("http://localhost:8000/cart/detail/",{credentials:"include",headers:{"X-CSRFToken":u}});if(!e.ok)throw Error("Failed to fetch cart");let t=await e.json();x(t)}catch(e){console.error("Error fetching cart:",e)}finally{c(!1)}},b=async e=>{if(d>0)return;m(e=>e+1);let a=t.find(t=>t.id===e.id),s=a?a.quantity+1:1;r(t=>a?t.map(t=>t.id===e.id?{...t,quantity:s,total_price:(parseFloat(e.price)*s).toFixed(2)}:t):[...t,{...e,quantity:1,total_price:e.price}]);try{let t=await fetch(`http://localhost:8000/cart/add/${e.id}/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":u},body:JSON.stringify({quantity:s,override:!0}),credentials:"include"});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to add item to cart")}let r=await t.json();x(r)}catch(e){console.error("Error adding to cart:",e),await h()}finally{m(e=>e-1)}},f=async e=>{if(!(d>0)){m(e=>e+1),r(t=>t.filter(t=>t.id!==e));try{let t=await fetch(`http://localhost:8000/cart/remove/${e}/`,{method:"POST",headers:{"X-CSRFToken":u},credentials:"include"});if(!t.ok)throw Error("Failed to remove item from cart");let r=await t.json();x(r)}catch(e){console.error("Error removing from cart:",e),await h()}finally{m(e=>e-1)}}},g=async(e,t)=>{if(!(d>0)){if(m(e=>e+1),t<=0){await f(e),m(e=>e-1);return}r(r=>r.map(r=>r.id===e?{...r,quantity:t,total_price:(parseFloat(r.price)*t).toFixed(2)}:r));try{let r=await fetch(`http://localhost:8000/cart/add/${e}/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":u},body:JSON.stringify({quantity:t,override:!0}),credentials:"include"});if(!r.ok)throw Error("Failed to update cart");let a=await r.json();x(a)}catch(e){console.error("Error updating cart:",e),await h()}finally{m(e=>e-1)}}};return(0,s.useEffect)(()=>{h()},[]),a.jsx(i.Provider,{value:{cart:t,cartTotal:n,addToCart:b,removeFromCart:f,updateCartItemQuantity:g,fetchCart:h,isLoading:o},children:e})},l=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},5346:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(7247),s=r(8964),i=r(7063);let n=({onSubmit:e,csrfToken:t,isSubmitting:r,error:s,formData:i,setFormData:n})=>{let l=e=>{let{name:t,value:r}=e.target;n(e=>({...e,[t]:r}))};return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-amber-100",children:[a.jsx("h2",{className:"text-2xl font-serif text-amber-900 mb-6",children:"Shipping Information"}),(0,a.jsxs)("form",{onSubmit:r=>{r.preventDefault(),e(i,t)},children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"First Name"}),a.jsx("input",{type:"text",name:"first_name",required:!0,value:i.first_name,onChange:l,className:"w-full px-3 py-2 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-amber-50/50"})]}),(0,a.jsxs)("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Last Name"}),a.jsx("input",{type:"text",name:"last_name",required:!0,value:i.last_name,onChange:l,className:"w-full px-3 py-2 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-amber-50/50"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Email"}),a.jsx("input",{type:"email",name:"email",required:!0,value:i.email,onChange:l,className:"w-full px-3 py-2 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-amber-50/50"})]}),(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"Address"}),a.jsx("input",{type:"text",name:"address",required:!0,value:i.address,onChange:l,className:"w-full px-3 py-2 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-amber-50/50"})]}),(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("label",{className:"block text-sm font-medium text-amber-800 mb-1",children:"City"}),a.jsx("input",{type:"text",name:"city",required:!0,value:i.city,onChange:l,className:"w-full px-3 py-2 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-amber-50/50"})]}),s&&a.jsx("div",{className:"mt-4 p-4 bg-red-50 text-red-700 rounded-lg border border-red-200",children:s}),a.jsx("button",{type:"submit",disabled:r,className:"mt-6 w-full bg-amber-800 text-amber-50 py-3 px-4 rounded-full hover:bg-amber-900 transition-colors disabled:bg-amber-400 font-medium",children:r?"Processing...":"Place Order"})]})]})},l=()=>{let{cart:e,cartTotal:t}=(0,i.j)();return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 border border-amber-100",children:[a.jsx("h2",{className:"text-2xl font-serif text-amber-900 mb-6",children:"Order Summary"}),(0,a.jsxs)("div",{className:"space-y-4",children:[e.map(e=>(0,a.jsxs)("div",{className:"flex justify-between pb-4 border-b border-amber-100",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-amber-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-amber-700",children:["Quantity: ",e.quantity]})]}),(0,a.jsxs)("p",{className:"font-medium text-amber-900",children:["$",e.total_price]})]},e.id)),a.jsx("div",{className:"pt-4 mt-4",children:(0,a.jsxs)("div",{className:"flex justify-between font-bold text-lg text-amber-900",children:[a.jsx("p",{children:"Total"}),(0,a.jsxs)("p",{children:["$",t]})]})})]})]})},o=()=>{let{cart:e,cartTotal:t,fetchCart:r}=(0,i.j)(),[o,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)(null),[u,p]=(0,s.useState)(""),[x,h]=(0,s.useState)({first_name:"",last_name:"",email:"",address:"",city:""}),[b,f]=(0,s.useState)(!1),[g,v]=(0,s.useState)(null);(0,s.useEffect)(()=>{p((()=>{let e="csrftoken",t=null;if(document.cookie&&""!==document.cookie){let r=document.cookie.split(";");for(let a=0;a<r.length;a++){let s=r[a].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}}return t})()||"")},[]);let j=async(t,a)=>{c(!0),m(null);try{let s=await fetch("http://localhost:8000/api/orders/create/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":a},credentials:"include",body:JSON.stringify({...t,items:e.map(e=>({product:e.id,price:e.price,quantity:e.quantity}))})});if(!s.ok){let e=await s.json();throw Error(e.detail||"Failed to create order")}let i=await s.json();v(i),f(!0),await r()}catch(e){m(e instanceof Error?e.message:"An error occurred during checkout")}finally{c(!1)}};return e.length?(0,a.jsxs)("div",{className:"min-h-screen bg-cover bg-center bg-fixed flex flex-col items-center py-12 relative",style:{backgroundImage:"url('/checkoutbg.jpg')"},children:[a.jsx("div",{className:"absolute inset-0 bg-black opacity-50"}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 relative z-10",children:[a.jsx("h1",{className:"text-3xl font-serif text-amber-50 mb-8 text-center",children:"Checkout"}),b?(0,a.jsxs)("div",{className:"bg-green-50 border-l-4 border-green-600 p-6 rounded-lg shadow-lg mb-4",role:"alert",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"text-2xl mr-2",children:"☕"}),a.jsx("h2",{className:"text-xl font-serif text-green-800",children:"Order Confirmed!"})]}),a.jsx("p",{className:"text-green-700",children:"Thank you for your order. We will start brewing right away!"}),(0,a.jsxs)("p",{className:"text-green-700 mt-2",children:["Order ID: ",g?.order_id]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[a.jsx(n,{onSubmit:j,csrfToken:u,isSubmitting:o,error:d,formData:x,setFormData:h}),a.jsx(l,{}),(0,a.jsxs)("p",{className:"text-gray-300",children:["Total: $",t]})]})]})]}):(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-amber-50 text-amber-900",children:[a.jsx("div",{className:"text-4xl mb-4",children:"☕"}),a.jsx("h1",{className:"text-3xl font-serif mb-2",children:"Checkout"}),a.jsx("p",{className:"text-lg mb-6",children:"Your cart is empty"})]})}},3567:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f,metadata:()=>b});var a=r(2051),s=r(7818),i=r.n(s),n=r(494),l=r.n(n),o=r(5329),c=r.n(o),d=r(9082),m=r.n(d),u=r(225),p=r.n(u);r(5023);var x=r(5347);let h=(0,x.createProxy)(String.raw`/app/src/app/context/CartContext.tsx#CartProvider`);(0,x.createProxy)(String.raw`/app/src/app/context/CartContext.tsx#useCart`);let b={title:"Bean Scene",description:"SIp Sustainably"};function f({children:e}){return a.jsx("html",{lang:"en",children:a.jsx(h,{children:a.jsx("body",{className:`${i().variable} ${l().variable} ${c().variable} ${m().variable} ${p().variable} antialiased`,children:e})})})}},2320:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(5347).createProxy)(String.raw`/app/src/app/menu/cart/checkout/page.tsx#default`)},3881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(4564);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[379,460,564],()=>r(9285));module.exports=a})();